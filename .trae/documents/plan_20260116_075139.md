## 修复计划

### 1. **修复hook返回值命名不匹配问题**

* **问题**：SpeechSimulation组件中使用的`isListening`、`startListening`、`stopListening`与useSpeechRecognition hook实际返回的`isRecording`、`startRecording`、`stopRecording`命名不匹配

* **修复方案**：将useSpeechRecognition hook的返回值重命名为与组件期望的一致，或者修改组件中的解构命名

### 2. **修复转录文本使用问题**

* **问题**：在评估演讲时直接使用了`transcript`变量，而正确的完整转录文本应该是`fullTranscript`

* **修复方案**：在useSpeechRecognition hook中确保返回的`transcript`就是完整的转录文本，或者修改组件中的评估逻辑使用正确的转录文本

### 3. **提取重复代码到单独函数**

* **问题**：handleStopSpeech和handleTimeUp函数执行了几乎相同的逻辑，存在代码重复

* **修复方案**：将共同的逻辑提取到一个单独的`processSpeechEvaluation`函数中，然后在两个函数中调用

### 4. **优化状态管理**

* **问题**：useEffect中使用了双重状态管理（isListening和isRecording），可能导致不一致

* **修复方案**：简化状态管理，确保语音识别和录音状态与state.isSpeaking保持同步

### 5. **修复hook状态命名混淆问题**

* **问题**：useSpeechRecognition hook使用`isRecording`表示语音识别状态，与useAudioRecorder hook的`isRecording`容易混淆

* **修复方案**：将useSpeechRecognition hook中的状态重命名为`isListening`，使其更准确地反映其功能

## 修复步骤

1. 修改`useSpeechRecognition.ts`文件：

   * 将`isRecording`状态重命名为`isListening`

   * 将`startRecording`函数重命名为`startListening`

   * 将`stopRecording`函数重命名为`stopListening`

   * 确保返回的`transcript`是完整的转录文本

2. 修改`SpeechSimulation.tsx`文件：

   * 提取`processSpeechEvaluation`函数，包含共同的评估逻辑

   * 在`handleStopSpeech`和`handleTimeUp`函数中调用该函数

   * 确保使用正确的转录文本进行评估

   * 简化useEffect中的状态管理逻辑

3. 测试修复后的功能，确保语音

